"use strict";function _defineProperties(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Transaction=function t(e,n,a,i){_classCallCheck(this,t),this.amount=e,this.description=n,this.date=a,this.transactionId=i},TransactionList=function(){function t(){_classCallCheck(this,t),this.transaction=document.querySelector(".add__description"),this.incomeBudgetList=document.querySelector(".income__list"),this.expenseBudgetList=document.querySelector(".expenses__list"),this.transactionAmount=document.querySelector(".add__value"),this.totalBudgetValue=document.querySelector(".budget__value"),this.totalIncome=document.querySelector(".budget__income--value"),this.totalExpenses=document.querySelector(".budget__expenses--value"),this.totalExpensesPct=document.querySelector(".budget__expenses--percentage"),this.budgetDate=document.querySelector(".budget__title--month"),this.itemValue=document.querySelector(".item__value"),this.itemList=document.querySelectorAll(".item"),this.incomeList=[],this.expenseList=[],this.id=1}return _createClass(t,[{key:"findIncomeById",value:function(t,e){return t.find(function(t){return t.transactionId===parseInt(e)})}},{key:"findExpensesById",value:function(t,e){return t.find(function(t){return t.transactionId===parseInt(e)})}},{key:"removeTransactionFromList",value:function(t,e){var n=t.indexOf(e);t.splice(n,1)}},{key:"getCurrentDate",value:function(){var t=new Date,e=t.toLocaleString("default",{month:"short"}),n=t.getFullYear(),a=t.getDate();return"".concat(e," ").concat(a,", ").concat(n)}},{key:"getSumOfIncome",value:function(){var t=0;return this.incomeList.forEach(function(e){t+=parseFloat(e.amount)}),t}},{key:"getSumOfExpenses",value:function(){var t=0;return this.expenseList.forEach(function(e){t+=parseFloat(e.amount)}),t}},{key:"updateBudgetDate",value:function(){var t=new Date,e=t.toLocaleString("default",{month:"long"}),n=t.getFullYear(),a="".concat(e," ").concat(n);this.budgetDate.innerText=a}},{key:"updatePercentageOfExpenses",value:function(){var t=this.getSumOfIncome();this.expenseList.forEach(function(e){var n=document.querySelector('[data-transaction-id="'.concat(e.transactionId,'"]')).children[1].children[1],a=Math.abs(Math.round(parseFloat(e.amount)/parseFloat(t)*100,2));n.innerText="".concat(a," %")})}},{key:"resetInputValue",value:function(){this.transaction.value="",this.transactionAmount.value=0}},{key:"totalBudgetCalculator",value:function(){var t,e=this.getSumOfIncome(),n=this.getSumOfExpenses(),a=0;a=e+n,t=Math.abs(Math.round(n/e*100,2)),a=a>0?"+ $".concat(a):"- $".concat(Math.abs(a)),this.totalIncome.innerText="+ $".concat(e),this.totalExpenses.innerText="- $".concat(Math.abs(n)),this.totalBudgetValue.innerText=a,this.totalExpensesPct.innerText="".concat(t," %")}},{key:"addNewTransaction",value:function(){var t=this.transaction.value,e=this.transactionAmount.value,n=Math.abs(Math.round(parseFloat(e)/parseFloat(this.getSumOfIncome())*100,2));if(t.trim().length&&0!==parseFloat(e)&&parseFloat(e)){var a=new Transaction(e,t,this.getCurrentDate(),this.id);if(this.transactionAmount.value<0){var i='<div class="item" data-transaction-id= "'.concat(a.transactionId,'">\n        <div class="item__description">').concat(a.description,' </div>\n        <div class="right">\n          <div class="item__value">- $').concat(Math.abs(a.amount),'</div>\n          <div class="item__percentage">').concat(n,'%</div>\n          <div class="item__delete">\n            <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button>\n          </div>\n        </div>\n        <div class="item__date">').concat(a.date,"</div>");this.expenseBudgetList.insertAdjacentHTML("afterbegin",i),this.expenseList.push(a)}else{var s='<div class="item" data-transaction-id="'.concat(a.transactionId,'">\n        <div class="item__description">').concat(a.description,'</div>            \n        <div class="right">\n          <div class="item__value">+ $').concat(a.amount,'</div>\n          <div class="item__delete">\n            <button class="item__delete--btn">\n              <i class="ion-ios-close-outline"></i>\n            </button>\n          </div>\n        </div>\n        <div class="item__date">').concat(a.date,"</div>");this.incomeBudgetList.insertAdjacentHTML("afterbegin",s),this.incomeList.push(a),this.updatePercentageOfExpenses()}this.id++,transactionList.resetInputValue(),transactionList.totalBudgetCalculator()}else alert("Your input is empty, please enter a transaction name and/or value.")}},{key:"removeTransaction",value:function(t){if(this.findExpensesById(this.expenseList,t)){var e=this.findExpensesById(this.expenseList,t);this.removeTransactionFromList(this.expenseList,e)}else{var n=this.findIncomeById(this.incomeList,t);this.removeTransactionFromList(this.incomeList,n),this.updatePercentageOfExpenses()}transactionList.totalBudgetCalculator()}}]),t}(),transactionList=new TransactionList;document.querySelector(".add__btn").addEventListener("click",function(t){transactionList.addNewTransaction()}),document.addEventListener("click",function(t){if("ion-ios-close-outline"===t.target.className){var e=t.target.parentElement.parentElement.parentElement.parentElement.getAttribute("data-transaction-id");transactionList.removeTransaction(e),document.querySelector('[data-transaction-id="'.concat(e,'"]')).remove()}}),window.onload=function(){transactionList.updateBudgetDate(),transactionList.resetInputValue()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhbGN1bGF0b3IuanMiXSwibmFtZXMiOlsiX2RlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJfY3JlYXRlQ2xhc3MiLCJDb25zdHJ1Y3RvciIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiVHlwZUVycm9yIiwiVHJhbnNhY3Rpb24iLCJhbW91bnQiLCJkZXNjcmlwdGlvbiIsImRhdGUiLCJpZCIsInRoaXMiLCJ0cmFuc2FjdGlvbklkIiwiVHJhbnNhY3Rpb25MaXN0IiwidHJhbnNhY3Rpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbmNvbWVCdWRnZXRMaXN0IiwiZXhwZW5zZUJ1ZGdldExpc3QiLCJ0cmFuc2FjdGlvbkFtb3VudCIsInRvdGFsQnVkZ2V0VmFsdWUiLCJ0b3RhbEluY29tZSIsInRvdGFsRXhwZW5zZXMiLCJ0b3RhbEV4cGVuc2VzUGN0IiwiYnVkZ2V0RGF0ZSIsIml0ZW1WYWx1ZSIsIml0ZW1MaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImluY29tZUxpc3QiLCJleHBlbnNlTGlzdCIsInZhbHVlIiwiaW5jb21lSWQiLCJmaW5kIiwiY3VycmVudEluY29tZSIsInBhcnNlSW50IiwiZXhwZW5zZUlkIiwiY3VycmVudEV4cGVuc2UiLCJ0cmFuc2FjdGlvbkxpc3QiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJjdXJyZW50RGF0ZSIsIkRhdGUiLCJtb250aCIsInRvTG9jYWxlU3RyaW5nIiwieWVhciIsImdldEZ1bGxZZWFyIiwiZGF5IiwiZ2V0RGF0ZSIsImNvbmNhdCIsImluY29tZVN1bSIsImZvckVhY2giLCJpbmNvbWUiLCJwYXJzZUZsb2F0IiwiZXhwZW5zZVN1bSIsImZpbmFsQnVkZ2V0RGF0ZSIsImlubmVyVGV4dCIsInRvdGFsQnVkZ2V0IiwiZ2V0U3VtT2ZJbmNvbWUiLCJleHBlbnNlIiwiZXhwZW5zZVBjdEh0bWwiLCJjaGlsZHJlbiIsImV4cGVuc2VQY3QiLCJNYXRoIiwiYWJzIiwicm91bmQiLCJ0b3RhbEV4cGVuc2VQY3QiLCJnZXRTdW1PZkV4cGVuc2VzIiwiZGVzY3JpcHRpb25PZlRyYW5zYWN0aW9uIiwidmFsdWVPZkV4cGVuc2UiLCJwZXJjZW50YWdlT2ZFeHBlbnNlIiwidHJpbSIsImdldEN1cnJlbnREYXRlIiwibmV3RXhwZW5zZSIsImluc2VydEFkamFjZW50SFRNTCIsInB1c2giLCJuZXdJbmNvbWUiLCJ1cGRhdGVQZXJjZW50YWdlT2ZFeHBlbnNlcyIsInJlc2V0SW5wdXRWYWx1ZSIsInRvdGFsQnVkZ2V0Q2FsY3VsYXRvciIsImFsZXJ0IiwiZmluZEV4cGVuc2VzQnlJZCIsImV4cGVuc2VUb0RlbGV0ZSIsInJlbW92ZVRyYW5zYWN0aW9uRnJvbUxpc3QiLCJpbmNvbWVUb0RlbGV0ZSIsImZpbmRJbmNvbWVCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiYWRkTmV3VHJhbnNhY3Rpb24iLCJjbGFzc05hbWUiLCJwYXJlbnRFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwicmVtb3ZlVHJhbnNhY3Rpb24iLCJyZW1vdmUiLCJ3aW5kb3ciLCJvbmxvYWQiLCJ1cGRhdGVCdWRnZXREYXRlIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBLFNBQVNBLGtCQUFrQkMsRUFBUUMsR0FBUyxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLElBQUlFLEVBQWFILEVBQU1DLEdBQUlFLEVBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFBT0QsRUFBV0UsY0FBZSxFQUFVLFVBQVdGLElBQVlBLEVBQVdHLFVBQVcsR0FBTUMsT0FBT0MsZUFBZVQsRUFBUUksRUFBV00sSUFBS04sSUFFN1MsU0FBU08sYUFBYUMs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Z0JBQWdCMEMsNEJBSWJsRSxFQXBLMEIsR0F1Sy9Cd0IsZ0JBQWtCLElBQUl4QixnQkFFMUJFLFNBQVNDLGNBQWMsYUFBYXNFLGlCQUFpQixRQUFTLFNBQVVDLEdBQ3RFbEQsZ0JBQWdCbUQsc0JBRWxCekUsU0FBU3VFLGlCQUFpQixRQUFTLFNBQVVDLEdBQzNDLEdBQStCLDBCQUEzQkEsRUFBTXBHLE9BQU9zRyxVQUF1QyxDQUN0RCxJQUFJN0UsRUFBZ0IyRSxFQUFNcEcsT0FBT3VHLGNBQWNBLGNBQWNBLGNBQWNBLGNBQWNDLGFBQWEsdUJBQ3RHdEQsZ0JBQWdCdUQsa0JBQWtCaEYsR0FDbENHLFNBQVNDLGNBQWMseUJBQTBCaUMsT0FBT3JDLEVBQWUsT0FBUWlGLFlBSW5GQyxPQUFPQyxPQUFTLFdBQ2QxRCxnQkFBZ0IyRCxtQkFDaEIzRCxnQkFBZ0J5QyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFRyYW5zYWN0aW9uIHtcbiAgY29uc3RydWN0b3IoYW1vdW50LCBkZXNjcmlwdGlvbiwgZGF0ZSwgaWQpe1xuICAgIHRoaXMuYW1vdW50ID0gYW1vdW50O1xuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICB0aGlzLmRhdGUgPSBkYXRlO1xuICAgIHRoaXMudHJhbnNhY3Rpb25JZCA9IGlkO1xuICB9XG59XG5cbmNsYXNzIFRyYW5zYWN0aW9uTGlzdCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fZGVzY3JpcHRpb25cIik7XG4gICAgdGhpcy5pbmNvbWVCdWRnZXRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmNvbWVfX2xpc3RcIik7XG4gICAgdGhpcy5leHBlbnNlQnVkZ2V0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZXhwZW5zZXNfX2xpc3RcIik7XG4gICAgdGhpcy50cmFuc2FjdGlvbkFtb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkX192YWx1ZVwiKTtcbiAgICB0aGlzLnRvdGFsQnVkZ2V0VmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJ1ZGdldF9fdmFsdWVcIik7XG4gICAgdGhpcy50b3RhbEluY29tZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVkZ2V0X19pbmNvbWUtLXZhbHVlXCIpO1xuICAgIHRoaXMudG90YWxFeHBlbnNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVkZ2V0X19leHBlbnNlcy0tdmFsdWVcIik7XG4gICAgdGhpcy50b3RhbEV4cGVuc2VzUGN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idWRnZXRfX2V4cGVuc2VzLS1wZXJjZW50YWdlXCIpO1xuICAgIHRoaXMuYnVkZ2V0RGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVkZ2V0X190aXRsZS0tbW9udGhcIik7XG4gICAgdGhpcy5pdGVtVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLml0ZW1fX3ZhbHVlXCIpO1xuICAgIHRoaXMuaXRlbUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLml0ZW1cIik7XG4gICAgdGhpcy5pbmNvbWVMaXN0ID0gW107XG4gICAgdGhpcy5leHBlbnNlTGlzdCA9IFtdO1xuICAgIHRoaXMuaWQgPSAxO1xuICB9XG5cbiAgZmluZEluY29tZUJ5SWQoaW5jb21lTGlzdCwgaW5jb21lSWQpIHtcbiAgICByZXR1cm4gaW5jb21lTGlzdC5maW5kKChjdXJyZW50SW5jb21lKSA9PiB7XG4gICAgICByZXR1cm4gY3VycmVudEluY29tZS50cmFuc2FjdGlvbklkID09PSBwYXJzZUludChpbmNvbWVJZCk7XG4gICAgfSk7XG4gIH1cblxuICBmaW5kRXhwZW5zZXNCeUlkKGV4cGVuc2VMaXN0LCBleHBlbnNlSWQpIHtcbiAgICByZXR1cm4gZXhwZW5zZUxpc3QuZmluZCgoY3VycmVudEV4cGVuc2UpID0+IHtcbiAgICAgIHJldHVybiBjdXJyZW50RXhwZW5zZS50cmFuc2FjdGlvbklkID09PSBwYXJzZUludChleHBlbnNlSWQpO1xuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlVHJhbnNhY3Rpb25Gcm9tTGlzdCh0cmFuc2FjdGlvbkxpc3QsIHRyYW5zYWN0aW9uKSB7XG4gICAgY29uc3QgaW5kZXggPSB0cmFuc2FjdGlvbkxpc3QuaW5kZXhPZih0cmFuc2FjdGlvbik7XG4gICAgdHJhbnNhY3Rpb25MaXN0LnNwbGljZShpbmRleCwgMSk7XG4gIH1cblxuICBnZXRDdXJyZW50RGF0ZSgpIHtcbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgbW9udGggPSBjdXJyZW50RGF0ZS50b0xvY2FsZVN0cmluZygnZGVmYXVsdCcsIHsgbW9udGg6ICdzaG9ydCcgfSk7XG4gICAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgY29uc3QgZGF5ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IGZpbmFsRGF0ZSA9IGAke21vbnRofSAke2RheX0sICR7eWVhcn1gO1xuICAgIFxuICAgIHJldHVybiBmaW5hbERhdGU7XG4gIH1cblxuICBnZXRTdW1PZkluY29tZSgpe1xuICAgIGxldCBpbmNvbWVTdW0gPSAwO1xuXG4gICAgdGhpcy5pbmNvbWVMaXN0LmZvckVhY2goIGluY29tZSA9PiB7XG4gICAgICBpbmNvbWVTdW0gPSBpbmNvbWVTdW0gKyBwYXJzZUZsb2F0KGluY29tZS5hbW91bnQpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gaW5jb21lU3VtO1xuICB9XG5cbiAgZ2V0U3VtT2ZFeHBlbnNlcygpe1xuICAgIGxldCBleHBlbnNlU3VtID0gMDtcblxuICAgIHRoaXMuZXhwZW5zZUxpc3QuZm9yRWFjaCggaW5jb21lID0+IHtcbiAgICAgIGV4cGVuc2VTdW0gPSBleHBlbnNlU3VtICsgcGFyc2VGbG9hdChpbmNvbWUuYW1vdW50KTtcbiAgICB9KVxuXG4gICAgcmV0dXJuIGV4cGVuc2VTdW07XG4gIH1cblxuXG4gIHVwZGF0ZUJ1ZGdldERhdGUoKSB7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IG1vbnRoID0gY3VycmVudERhdGUudG9Mb2NhbGVTdHJpbmcoJ2RlZmF1bHQnLCB7IG1vbnRoOiAnbG9uZycgfSk7XG4gICAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgY29uc3QgZmluYWxCdWRnZXREYXRlID0gYCR7bW9udGh9ICR7eWVhcn1gO1xuXG4gICAgdGhpcy5idWRnZXREYXRlLmlubmVyVGV4dCA9IGZpbmFsQnVkZ2V0RGF0ZTtcbiAgfVxuXG4gIHVwZGF0ZVBlcmNlbnRhZ2VPZkV4cGVuc2VzKCkge1xuICAgIGxldCB0b3RhbEJ1ZGdldCA9ICB0aGlzLmdldFN1bU9mSW5jb21lKCk7XG5cbiAgICB0aGlzLmV4cGVuc2VMaXN0LmZvckVhY2goZXhwZW5zZSA9PiB7XG4gICAgICBjb25zdCBleHBlbnNlSHRtbERvY3VtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdHJhbnNhY3Rpb24taWQ9XCIke2V4cGVuc2UudHJhbnNhY3Rpb25JZH1cIl1gKTtcbiAgICAgIGNvbnN0IGV4cGVuc2VQY3RIdG1sID0gZXhwZW5zZUh0bWxEb2N1bWVudC5jaGlsZHJlblsxXS5jaGlsZHJlblsxXTtcbiAgICAgIGNvbnN0IGV4cGVuc2VQY3QgPSBNYXRoLmFicyhNYXRoLnJvdW5kKChwYXJzZUZsb2F0KGV4cGVuc2UuYW1vdW50KSAvIHBhcnNlRmxvYXQodG90YWxCdWRnZXQpKSAqIDEwMCwgMikpO1xuXG4gICAgICBleHBlbnNlUGN0SHRtbC5pbm5lclRleHQgPSBgJHtleHBlbnNlUGN0fSAlYDtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0SW5wdXRWYWx1ZSgpIHtcbiAgICB0aGlzLnRyYW5zYWN0aW9uLnZhbHVlID0gXCJcIlxuICAgIHRoaXMudHJhbnNhY3Rpb25BbW91bnQudmFsdWUgPSAwXG4gIH1cblxuICB0b3RhbEJ1ZGdldENhbGN1bGF0b3IoKSB7XG4gICAgbGV0IGluY29tZVN1bSA9IHRoaXMuZ2V0U3VtT2ZJbmNvbWUoKTtcbiAgICBsZXQgZXhwZW5zZVN1bSA9IHRoaXMuZ2V0U3VtT2ZFeHBlbnNlcygpO1xuICAgIGxldCB0b3RhbEJ1ZGdldCA9IDA7XG4gICAgbGV0IHRvdGFsRXhwZW5zZVBjdCA9IDA7XG5cbiAgICB0b3RhbEJ1ZGdldCA9IGluY29tZVN1bSArIGV4cGVuc2VTdW07XG4gICAgdG90YWxFeHBlbnNlUGN0ICA9IE1hdGguYWJzKE1hdGgucm91bmQoKGV4cGVuc2VTdW0gLyBpbmNvbWVTdW0pICogMTAwLCAyKSk7XG5cbiAgICBpZih0b3RhbEJ1ZGdldCA+IDApIHtcbiAgICAgIHRvdGFsQnVkZ2V0ID0gYCsgJCR7dG90YWxCdWRnZXR9YDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0b3RhbEJ1ZGdldCA9IGAtICQke01hdGguYWJzKHRvdGFsQnVkZ2V0KX1gO1xuICAgIH1cbiAgICBcbiAgICB0aGlzLnRvdGFsSW5jb21lLmlubmVyVGV4dCA9IGArICQke2luY29tZVN1bX1gO1xuICAgIHRoaXMudG90YWxFeHBlbnNlcy5pbm5lclRleHQgPSBgLSAkJHtNYXRoLmFicyhleHBlbnNlU3VtKX1gO1xuICAgIHRoaXMudG90YWxCdWRnZXRWYWx1ZS5pbm5lclRleHQgPSB0b3RhbEJ1ZGdldDtcbiAgICB0aGlzLnRvdGFsRXhwZW5zZXNQY3QuaW5uZXJUZXh0ID0gYCR7dG90YWxFeHBlbnNlUGN0fSAlYDtcbiAgfVxuXG4gIGFkZE5ld1RyYW5zYWN0aW9uKCkge1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uT2ZUcmFuc2FjdGlvbiA9IHRoaXMudHJhbnNhY3Rpb24udmFsdWU7XG4gICAgY29uc3QgdmFsdWVPZkV4cGVuc2UgPSB0aGlzLnRyYW5zYWN0aW9uQW1vdW50LnZhbHVlO1xuICAgIGNvbnN0IHBlcmNlbnRhZ2VPZkV4cGVuc2UgPSBNYXRoLmFicyhNYXRoLnJvdW5kKChwYXJzZUZsb2F0KHZhbHVlT2ZFeHBlbnNlKSAvIHBhcnNlRmxvYXQodGhpcy5nZXRTdW1PZkluY29tZSgpKSkgKiAxMDAsIDIpKTtcblxuICAgIGlmICghZGVzY3JpcHRpb25PZlRyYW5zYWN0aW9uLnRyaW0oKS5sZW5ndGggfHwgcGFyc2VGbG9hdCh2YWx1ZU9mRXhwZW5zZSkgPT09IDAgfHwgIXBhcnNlRmxvYXQodmFsdWVPZkV4cGVuc2UpKSB7XG4gICAgICBhbGVydChcIllvdXIgaW5wdXQgaXMgZW1wdHksIHBsZWFzZSBlbnRlciBhIHRyYW5zYWN0aW9uIG5hbWUgYW5kL29yIHZhbHVlLlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih2YWx1ZU9mRXhwZW5zZSwgZGVzY3JpcHRpb25PZlRyYW5zYWN0aW9uLCB0aGlzLmdldEN1cnJlbnREYXRlKCksIHRoaXMuaWQpO1xuXG4gICAgaWYgKHRoaXMudHJhbnNhY3Rpb25BbW91bnQudmFsdWUgPCAwKSB7XG4gICAgICBjb25zdCBuZXdFeHBlbnNlID0gXG4gICAgICAgIGA8ZGl2IGNsYXNzPVwiaXRlbVwiIGRhdGEtdHJhbnNhY3Rpb24taWQ9IFwiJHt0cmFuc2FjdGlvbi50cmFuc2FjdGlvbklkfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4ke3RyYW5zYWN0aW9uLmRlc2NyaXB0aW9ufSA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInJpZ2h0XCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX3ZhbHVlXCI+LSAkJHsoTWF0aC5hYnModHJhbnNhY3Rpb24uYW1vdW50KSl9PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX3BlcmNlbnRhZ2VcIj4ke3BlcmNlbnRhZ2VPZkV4cGVuc2V9JTwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2RhdGVcIj4ke3RyYW5zYWN0aW9uLmRhdGV9PC9kaXY+YDtcbiAgICAgIFxuICAgICAgdGhpcy5leHBlbnNlQnVkZ2V0TGlzdC5pbnNlcnRBZGphY2VudEhUTUwoXCJhZnRlcmJlZ2luXCIsIG5ld0V4cGVuc2UpO1xuICAgICAgdGhpcy5leHBlbnNlTGlzdC5wdXNoKHRyYW5zYWN0aW9uKTtcbiAgICB9IFxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgbmV3SW5jb21lID0gXG4gICAgICAgIGA8ZGl2IGNsYXNzPVwiaXRlbVwiIGRhdGEtdHJhbnNhY3Rpb24taWQ9XCIke3RyYW5zYWN0aW9uLnRyYW5zYWN0aW9uSWR9XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19kZXNjcmlwdGlvblwiPiR7dHJhbnNhY3Rpb24uZGVzY3JpcHRpb259PC9kaXY+ICAgICAgICAgICAgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJyaWdodFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPisgJCR7dHJhbnNhY3Rpb24uYW1vdW50fTwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj5cbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImlvbi1pb3MtY2xvc2Utb3V0bGluZVwiPjwvaT5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW1fX2RhdGVcIj4ke3RyYW5zYWN0aW9uLmRhdGV9PC9kaXY+YDtcblxuICAgICAgICB0aGlzLmluY29tZUJ1ZGdldExpc3QuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYWZ0ZXJiZWdpblwiLCBuZXdJbmNvbWUpO1xuICAgICAgICB0aGlzLmluY29tZUxpc3QucHVzaCh0cmFuc2FjdGlvbik7XG4gICAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZU9mRXhwZW5zZXMoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlkKys7XG4gICAgdHJhbnNhY3Rpb25MaXN0LnJlc2V0SW5wdXRWYWx1ZSgpO1xuICAgIHRyYW5zYWN0aW9uTGlzdC50b3RhbEJ1ZGdldENhbGN1bGF0b3IoKTtcbiAgfVxuXG4gIHJlbW92ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uSWQpIHtcbiAgICBpZiAodGhpcy5maW5kRXhwZW5zZXNCeUlkKHRoaXMuZXhwZW5zZUxpc3QsIHRyYW5zYWN0aW9uSWQpKSB7XG4gICAgICBjb25zdCBleHBlbnNlVG9EZWxldGUgPSB0aGlzLmZpbmRFeHBlbnNlc0J5SWQodGhpcy5leHBlbnNlTGlzdCwgdHJhbnNhY3Rpb25JZCk7ICAgICAgXG4gICAgICB0aGlzLnJlbW92ZVRyYW5zYWN0aW9uRnJvbUxpc3QodGhpcy5leHBlbnNlTGlzdCwgZXhwZW5zZVRvRGVsZXRlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBjb25zdCBpbmNvbWVUb0RlbGV0ZSA9IHRoaXMuZmluZEluY29tZUJ5SWQodGhpcy5pbmNvbWVMaXN0LCB0cmFuc2FjdGlvbklkKTtcbiAgICAgIHRoaXMucmVtb3ZlVHJhbnNhY3Rpb25Gcm9tTGlzdCh0aGlzLmluY29tZUxpc3QsIGluY29tZVRvRGVsZXRlKTtcbiAgICAgIHRoaXMudXBkYXRlUGVyY2VudGFnZU9mRXhwZW5zZXMoKTtcbiAgICB9XG5cbiAgICB0cmFuc2FjdGlvbkxpc3QudG90YWxCdWRnZXRDYWxjdWxhdG9yKCk7XG4gIH1cbn1cblxuY29uc3QgdHJhbnNhY3Rpb25MaXN0ID0gbmV3IFRyYW5zYWN0aW9uTGlzdCgpO1xuXG4vL0V2ZW50IExpc3RlbmVyc1xuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZF9fYnRuJykuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgdHJhbnNhY3Rpb25MaXN0LmFkZE5ld1RyYW5zYWN0aW9uKCk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgaWYoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJpb24taW9zLWNsb3NlLW91dGxpbmVcIikge1xuICAgIGNvbnN0IHRyYW5zYWN0aW9uSWQgPSBldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRyYW5zYWN0aW9uLWlkXCIpO1xuICAgIHRyYW5zYWN0aW9uTGlzdC5yZW1vdmVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbklkKTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXRyYW5zYWN0aW9uLWlkPVwiJHt0cmFuc2FjdGlvbklkfVwiXWApLnJlbW92ZSgpO1xuICB9XG59KTtcblxud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICB0cmFuc2FjdGlvbkxpc3QudXBkYXRlQnVkZ2V0RGF0ZSgpO1xuICB0cmFuc2FjdGlvbkxpc3QucmVzZXRJbnB1dFZhbHVlKCk7XG59Il0sImZpbGUiOiJidW5kbGUtbWluLmpzIn0=
